<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Nginx Reverse Proxy" /><meta property="og:locale" content="en" /><meta name="description" content="Getting Started" /><meta property="og:description" content="Getting Started" /><link rel="canonical" href="https://codefreak558.github.io/posts/nginx-reverse-proxy/" /><meta property="og:url" content="https://codefreak558.github.io/posts/nginx-reverse-proxy/" /><meta property="og:site_name" content="Homelab Docs" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-09-23T18:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Nginx Reverse Proxy" /><meta name="twitter:site" content="@codefreak6" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-09-23T18:00:00+02:00","datePublished":"2023-09-23T18:00:00+02:00","description":"Getting Started","headline":"Nginx Reverse Proxy","mainEntityOfPage":{"@type":"WebPage","@id":"https://codefreak558.github.io/posts/nginx-reverse-proxy/"},"url":"https://codefreak558.github.io/posts/nginx-reverse-proxy/"}</script><title>Nginx Reverse Proxy | Homelab Docs</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Homelab Docs"><meta name="application-name" content="Homelab Docs"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="https://avatars.githubusercontent.com/u/46318596?v=4" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><h1 class="site-title"> <a href="/">Homelab Docs</a></h1><p class="site-subtitle fst-italic mb-0">A homelab documentation page</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/codefreak558" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/codefreak6" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['codefreak','darkblue.co.za'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Nginx Reverse Proxy</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4" ><article class="px-1"><header><h1 data-toc-skip>Nginx Reverse Proxy</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1695484800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 23, 2023 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/codefreak6">Aidan Taylor</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="899 words" > <em>4 min</em> read</span></div></div></header><div class="content"><h2 id="getting-started"><span class="me-2">Getting Started</span><a href="#getting-started" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Firstly we need to make sure we have docker and docker-compose installed and setup.</p><p>Once the has been done we need to set up the <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file for nginx. We can get the <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file from <a href="https://nginxproxymanager.com/guide/#hosting-your-home-network">Nginx Proxy Manager</a> or copy the following <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">app</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s1">'</span><span class="s">jc21/nginx-proxy-manager:latest'</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">80:80'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">81:81'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">443:443'</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./data:/data</span>
      <span class="pi">-</span> <span class="s">./letsencrypt:/etc/letsencrypt</span>
</pre></table></code></div></div><p>Once we have this made, make changed to the ports if needed.</p><h2 id="port-forwarding"><span class="me-2">Port Forwarding</span><a href="#port-forwarding" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Before we go any further we need to make sure that we are fowarding ports 80 and 443 to the ports that you have set in the docker compose file.</p><p>This can be done by looking up the name of your router and look up port fowarding ports 80 and 443 for your router.</p><h2 id="cloudflare-setup"><span class="me-2">Cloudflare setup</span><a href="#cloudflare-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this guide we use Cloudflare for our ssl creation. We will need to get our API key for Zone editing. We need this so that Nginx can create ssl certificates for our websites and hosts we want to forward out to the wider web.</p><p>This can be done by logging into your <a href="https://dash.cloudflare.com/">Cloudflare Dashboard</a>. Once we have logged in we go to Account, then API key. We can then create our API key using the Edit Zone templete. When we have our API key we need to keep this one side as Cloudflare doesn‚Äôt let you look at these API keys once they have been made.</p><p>The second step we need to do is create a DNS record for the service we want to forward out. We will set the subname for the DNS record and in the ip we will set it to our Public IP, you can get this by typing into Google ‚ÄúWhats my ip‚Äù. Once you type this Google will give you what your current public ip is.</p><h3 id="extra-setup"><span class="me-2">Extra setup</span><a href="#extra-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We need to make sure that in our SSL/TLS tab we have our encryption mode set to full or full (strict), along with going to ‚ÄúEdge Certificates‚Äù and making sure we have ‚ÄúAlways Use HTTPS‚Äù set to true. Once that is done we can go to our Nginx Setup</p><h2 id="nginx-setup"><span class="me-2">Nginx Setup</span><a href="#nginx-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that we have done all of this we can finnaly go to Nginxüéâ. You can get to Nginx by typing in the IP of the device you are hosting Nginx from along with the prot 81 at the end. For example http://192.168.1.50:81. This will then take you to the Nginix Proxy Manager website where you will fill in the default login details which should be:</p><ul><li>admin@example.com<li>changeme</ul><p>Once you have filled that in and press login you will be asked to change the details for the main Admin account.</p><h3 id="ssl-certificates"><span class="me-2">SSL Certificates</span><a href="#ssl-certificates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now that we have gained access to our Nginx instance we need to add our own SSL Cert. We do this by going to the SSL Certificates tab. This will take you to where you can fill in details for your SSL Cert. We will press on ‚ÄúAdd SSL Certificate‚Äù, then press ‚ÄúLet‚Äôs Encrypt‚Äù and it will bring up a form for us that we need to fill in. It should look like this:C</p><p><a href="/assets/img/posts/nginx-reverse-proxy-add-cert.webp" class="popup img-link "><img data-src="/assets/img/posts/nginx-reverse-proxy-add-cert.webp" alt="Nginx SSL Cert" class="lazyload" data-proofer-ignore></a></p><p>In here we need to fill in the domain names we wish to create a certificate for. What you can do is peg this SSL cert to one domain name or make a wildcard cert. In most cases creating a wildcard cert is easier to do and more effective. To create a wildcard cert we need to type in our domain name like so <code class="language-plaintext highlighter-rouge">*.example.com</code>. We will then select DNS Challenge, this will then give us a dropdown for DNS Provider. In here we will look for Cloudflare and select this. You should see something like this <a href="/assets/img/posts/nginx-reverse-proxy-dns-challange.webp" class="popup img-link "><img data-src="/assets/img/posts/nginx-reverse-proxy-dns-challange.webp" alt="Nginx SSL DNS" class="lazyload" data-proofer-ignore></a></p><p>Here is wherer we will take that API key we wrote down ealier and fill it in.</p><p>Once all of this has been done you will see that you now have yourself your own SSL cert.</p><p>We can now go onto the next step and that is creating our hosts.</p><h3 id="hosts"><span class="me-2">Hosts</span><a href="#hosts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>So to create a proxy host we need to press on the Hosts button in the nav bar. This will give us a dropdown in which we will press Proxy Hosts. You should then see a new blank page with the only notable things showing is ‚ÄúAdd Proxy Host‚Äù.</p><p>We will press ‚ÄúAdd Proxy Host‚Äù and this will give us a new form for us to fill in. We will go about everything the same way as before just this time for the domain name you will want to type the name of the service you want to forward, for example plex.example.com.</p><p>We will then type the IP of the machine that is hosting the service we will host. Once we have put the IP in we will need to put the port in. You can then tick ‚ÄúBlock Common Exploits‚Äù and then move onto the SSL tab.</p><p>Here you will select the SSL cert you just made and make sure to press Force SSL. This will make sure that your service will always use HTTPS.</p><p>Once this has been done you should be set, go to the domain name you just typed in and boom you are now hosting your service out to the internet with your own certs.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/homelab/">homelab</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/homelab/" class="post-tag no-text-decoration" >homelab</a> <a href="/tags/nginx/" class="post-tag no-text-decoration" >nginx</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Nginx%20Reverse%20Proxy%20-%20Homelab%20Docs&url=https%3A%2F%2Fcodefreak558.github.io%2Fposts%2Fnginx-reverse-proxy%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Nginx%20Reverse%20Proxy%20-%20Homelab%20Docs&u=https%3A%2F%2Fcodefreak558.github.io%2Fposts%2Fnginx-reverse-proxy%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fcodefreak558.github.io%2Fposts%2Fnginx-reverse-proxy%2F&text=Nginx%20Reverse%20Proxy%20-%20Homelab%20Docs" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/jellyfin-stack/">Jellyfin Docker</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/homelab/">homelab</a> <a class="post-tag btn btn-outline-primary" href="/tags/jellyfin/">jellyfin</a> <a class="post-tag btn btn-outline-primary" href="/tags/nginx/">nginx</a> <a class="post-tag btn btn-outline-primary" href="/tags/radarr/">radarr</a> <a class="post-tag btn btn-outline-primary" href="/tags/server/">server</a> <a class="post-tag btn btn-outline-primary" href="/tags/sonarr/">sonarr</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4 mb-5"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/jellyfin-stack/" class="post-preview card h-100"><div class="card-body"> <time class="small" data-ts="1695142800" data-df="ll" > Sep 19, 2023 </time><h4 class="pt-0 my-2">Jellyfin Docker</h4><div class="text-muted small"><p> Docker Compose Jellyfin After some searching for a good Jellyfin stack we came across the github repo made by AdrienPoupa, the repo is called Docker-Compose-Nas. This github repo fills our Jellyfi...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/jellyfin-stack/" class="btn btn-outline-primary" aria-label="Older" ><p>Jellyfin Docker</p></a><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p> ¬© <time>2023</time> <a href="https://twitter.com/codefreak6">Aidan Taylor</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/homelab/">homelab</a> <a class="post-tag btn btn-outline-primary" href="/tags/jellyfin/">jellyfin</a> <a class="post-tag btn btn-outline-primary" href="/tags/nginx/">nginx</a> <a class="post-tag btn btn-outline-primary" href="/tags/radarr/">radarr</a> <a class="post-tag btn btn-outline-primary" href="/tags/server/">server</a> <a class="post-tag btn btn-outline-primary" href="/tags/sonarr/">sonarr</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.9/dayjs.min.js,npm/dayjs@1.11.9/locale/en.min.js,npm/dayjs@1.11.9/plugin/relativeTime.min.js,npm/dayjs@1.11.9/plugin/localizedFormat.min.js,npm/tocbot@4.21.1/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/unregister.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
